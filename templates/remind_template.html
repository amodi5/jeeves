<!DOCTYPE html>
<html lang="en">
	<head>
		{% from 'macros.html' import blockers %}
	</head>
	<body>
		<div>
			<p style="text-align: center; font-size: smaller;">Reminder generated by {{header.user_email_address}} on {{header.date}} using the following blocker file: {{header.source}}</p>
			<p style="text-align: center;">Attention user, the following jobs are currently failing in CI. Please ensure each job listed has up-to-date blockers.</p>
		</div>
		<div>
			<table border="1">
				<thead>
					<tr>
						<th style="text-align: center;">OSP Version </th>
						<th style="text-align: center;">Job Name</th>
						<th style="text-align: center;">Last Build Number</th>
						<th style="text-align: center;">Compose</th>
						<th style="text-align: center;">Result</th>
						<th style="text-align: center;">Blockers</th>
					</tr>
				</thead>
				<tbody>
					{% for row in rows %}
					<tr>
						<td style="text-align: center;">{{row.osp_version}}</td>
						<td style="text-align: left;"><a href="{{row.job_url}}">{{row.job_name}}</a></td>	

						<!-- LCB is "UNSTABLE" -->
						{% if row.lcb_result == "UNSTABLE" %}
							<td style="text-align: center;"><a href="{{row.lcb_url}}">{{row.lcb_num}}</a></td>
							<td style="text-align: center;">{{row.compose}}</td>
							<td style="text-align: center;" bgcolor="#fdd500">{{row.lcb_result}}</td>
							<td>
								{{ blockers(row) }}
							</td>

						<!-- LCB is "FAILURE" -->
						{% elif row.lcb_result == "FAILURE" %}
							<td style="text-align: center;"><a href="{{row.lcb_url}}">{{row.lcb_num}}</a></td>
							<td style="text-align: center;">{{row.compose}}</td>
							<td style="text-align: center;" bgcolor="#ef2929">{{row.lcb_result}}</td>
							<td>
								{{ blockers(row) }}
							</td>

						<!-- LCB is set to any other state ('NO_KNOWN_BUILDS', 'ERROR') -->
						{% else %}
							{% if row.lcb_url != None %}
								<td style="text-align: center;"><a href="{{row.lcb_url}}">{{row.lcb_num}}</a></td>
							{% else %}
								<td style="text-align: center;">{{row.lcb_num}}</td>
							{% endif %}
							<td style="text-align: center;">{{row.compose}}</td>
							<td style="text-align: center;" bgcolor="#808080">{{row.lcb_result}}</td>
							<td style="text-align: center;"><p>N/A</p></td>
						{% endif %}
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
		<div>
			<p style="text-align: center; font-size: smaller;"><a href="https://github.com/nathan-weinberg/jeeves">Reminder generated by Jeeves</a></p>		
		</div>
	</body>
</html>
